<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Target Tracking Pro - AssetsToolsHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .tool-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .arena {
            height: 500px;
            background: #0d1117;
            border: 1px solid var(--card-border);
            border-radius: 1rem;
            position: relative;
            margin: 2rem 0;
            cursor: crosshair;
            overflow: hidden;
        }

        .target {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ef4444;
            transition: none;
            /* JS animation */
            box-shadow: 0 0 10px #ef4444;
        }

        .health-bar {
            position: absolute;
            bottom: 20px;
            left: 20%;
            width: 60%;
            height: 10px;
            background: #374151;
            border-radius: 5px;
            overflow: hidden;
        }

        .hp-fill {
            width: 100%;
            height: 100%;
            background: #10b981;
            transition: width 0.1s;
        }
    </style>
</head>

<body>
    <div class="main-content">
        <div class="tool-container">
            <h1 style="font-size: 2.5rem; font-weight:900; margin-bottom: 1rem;">Target Tracking Pro</h1>
            <p style="color:var(--text-muted); margin-bottom: 3rem;">Keep your cursor on the target to damage it.
                Destroy it as fast as possible.</p>

            <div style="display:flex; justify-content:center; gap:2rem; margin-bottom:2rem">
                <div>Time: <span id="time">0.0s</span></div>
                <div>DPS: <span id="dps">0</span></div>
            </div>

            <div class="arena" id="arena" onmousemove="track(event)">
                <div class="target" id="target"></div>

                <div class="health-bar">
                    <div class="hp-fill" id="hp"></div>
                </div>

                <div id="overlay"
                    style="position:absolute; inset:0; background:rgba(0,0,0,0.8); display:flex; justify-content:center; align-items:center; z-index:20">
                    <button class="join-pro-btn" style="width:auto" onclick="start()">START TRACKING</button>
                </div>
            </div>
        </div>
    </div>

    <script src="layout.js"></script>
    <script>
        const target = document.getElementById('target');
        const hpEl = document.getElementById('hp');
        const timeEl = document.getElementById('time');
        const dpsEl = document.getElementById('dps');
        const overlay = document.getElementById('overlay');
        const arena = document.getElementById('arena');

        let isRunning = false;
        let health = 1000;
        let startTime = 0;
        let isOnTarget = false;
        let tx = 200, ty = 200;
        let dx = 3, dy = 3;

        function start() {
            isRunning = true;
            health = 1000;
            startTime = performance.now();
            overlay.style.display = 'none';
            loop();
        }

        function loop() {
            if (!isRunning) return;

            // Move Target
            tx += dx;
            ty += dy;

            // Bounce
            if (tx <= 0 || tx >= arena.clientWidth - 40) dx *= -1;
            if (ty <= 0 || ty >= arena.clientHeight - 40) dy *= -1;

            // Random jitter
            if (Math.random() < 0.05) {
                dx += (Math.random() - 0.5) * 2;
                dy += (Math.random() - 0.5) * 2;
                // Cap speed
                dx = Math.max(-8, Math.min(8, dx));
                dy = Math.max(-8, Math.min(8, dy));
            }

            target.style.left = tx + 'px';
            target.style.top = ty + 'px';

            // Damage
            if (isOnTarget) {
                health -= 5;
                target.style.background = '#ffffff'; // White flash
                target.style.boxShadow = '0 0 20px #ffffff';
            } else {
                target.style.background = '#ef4444';
                target.style.boxShadow = '0 0 10px #ef4444';
            }

            hpEl.style.width = (health / 1000 * 100) + '%';

            const elapsed = (performance.now() - startTime) / 1000;
            timeEl.innerText = elapsed.toFixed(1) + 's';

            // DPS calc (Total Damage / Time)
            const damage = 1000 - health;
            dpsEl.innerText = elapsed > 0 ? Math.round(damage / elapsed) : 0;

            if (health <= 0) {
                end();
                return;
            }

            requestAnimationFrame(loop);
        }

        function end() {
            isRunning = false;
            overlay.style.display = 'flex';
            overlay.innerHTML = `
                <div style='text-align:center'>
                    <h2>TARGET DESTROYED</h2>
                    <p>Time: ${timeEl.innerText}</p>
                    <button class="join-pro-btn" style="width:auto; margin-top:1rem" onclick="start()">AGAIN</button>
                </div>
            `;
        }

        // Tracking Logic
        target.onmouseenter = () => isOnTarget = true;
        target.onmouseleave = () => isOnTarget = false;

    </script>
</body>

</html>