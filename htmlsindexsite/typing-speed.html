<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Speed Test - AssetsToolsHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .tool-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .typing-area {
            background: #0d1117;
            border: 1px solid var(--card-border);
            border-radius: 1.5rem;
            padding: 2rem;
            margin: 2rem 0;
            font-size: 1.5rem;
            line-height: 1.6;
            color: #6b7280;
            text-align: left;
            position: relative;
            outline: none;
            cursor: text;
        }

        .typing-area:focus {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.1);
        }

        .letter {
            transition: color 0.1s;
        }

        .letter.correct {
            color: white;
        }

        .letter.incorrect {
            color: #ef4444;
            text-decoration: underline;
        }

        .letter.current {
            border-left: 2px solid var(--primary);
            animation: blink 1s infinite;
            margin-left: -2px;
        }

        @keyframes blink {
            50% {
                border-color: transparent;
            }
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-bottom: 2rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-val {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .stat-lbl {
            color: var(--text-muted);
            font-weight: 600;
            margin-top: 5px;
        }

        .settings {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        button.opt {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            color: var(--text-muted);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
        }

        button.opt.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
    </style>
</head>

<body>
    <div class="main-content">
        <div class="tool-container">
            <h1 style="font-size: 2.5rem; font-weight:900; margin-bottom: 1rem;">Typing Speed Test</h1>
            <p style="color:var(--text-muted); margin-bottom: 3rem;">Measure your WPM with standard word lists.</p>

            <div class="settings">
                <button class="opt active" onclick="setTime(15)">15s</button>
                <button class="opt" onclick="setTime(30)">30s</button>
                <button class="opt" onclick="setTime(60)">60s</button>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-val" id="time">15</div>
                    <div class="stat-lbl">Time</div>
                </div>
                <div class="stat-item">
                    <div class="stat-val" id="wpm">0</div>
                    <div class="stat-lbl">WPM</div>
                </div>
                <div class="stat-item">
                    <div class="stat-val" id="acc">100%</div>
                    <div class="stat-lbl">Accuracy</div>
                </div>
            </div>

            <div class="typing-area" id="display" tabindex="0">
                <!-- Text injected here -->
            </div>

            <button class="join-pro-btn" style="width:100%; margin-top:1rem; opacity:0; pointer-events:none"
                id="restartBtn" onclick="reset()">RESTART TEST</button>
        </div>
    </div>

    <script src="layout.js"></script>
    <script>
        const words = "the be to of and a in that have I it for not on with he as you do at this but his by from they we say her she or an will my one all would there their what so up out if about who get which go me when make can like time no just him know take people into year your good some could them see other than then now look only come its over think also back after use two how our work first well way even new want because any these give day most us".split(' ');

        let timeLimit = 15;
        let timeLeft = 15;
        let isRunning = false;
        let interval;
        let correctChars = 0;
        let totalChars = 0;
        let errorCount = 0;
        let currentText = "";
        let cursorIndex = 0;

        const display = document.getElementById('display');
        const timeEl = document.getElementById('time');
        const wpmEl = document.getElementById('wpm');
        const accEl = document.getElementById('acc');
        const btn = document.getElementById('restartBtn');

        function setTime(t) {
            timeLimit = t;
            document.querySelectorAll('.opt').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            reset();
        }

        function generateText() {
            let res = [];
            for (let i = 0; i < 50; i++) res.push(words[Math.floor(Math.random() * words.length)]); // 50 words buffer
            return res.join(' ');
        }

        function render() {
            display.innerHTML = '';
            currentText.split('').forEach((char, i) => {
                const s = document.createElement('span');
                s.innerText = char;
                s.className = 'letter';
                if (i === 0) s.classList.add('current');
                display.appendChild(s);
            });
        }

        function updateVisuals() {
            const letters = display.querySelectorAll('.letter');
            letters.forEach((l, i) => {
                l.classList.remove('current');
                if (i === cursorIndex) l.classList.add('current');
            });

            // Auto scroll
            const current = letters[cursorIndex];
            if (current && current.offsetTop > display.scrollTop + 100) {
                display.scrollTop = current.offsetTop - 50;
            }
        }

        function start() {
            isRunning = true;
            interval = setInterval(() => {
                timeLeft--;
                timeEl.innerText = timeLeft;

                // Live WPM
                const elapsed = timeLimit - timeLeft;
                const wpm = Math.round((correctChars / 5) / (elapsed / 60));
                wpmEl.innerText = wpm;

                if (timeLeft <= 0) end();
            }, 1000);

            btn.style.opacity = '1';
            btn.style.pointerEvents = 'auto';
        }

        function end() {
            clearInterval(interval);
            isRunning = false;
            display.blur();
        }

        function reset() {
            clearInterval(interval);
            isRunning = false;
            timeLeft = timeLimit;
            timeEl.innerText = timeLeft;
            wpmEl.innerText = 0;
            accEl.innerText = '100%';

            cursorIndex = 0;
            correctChars = 0;
            totalChars = 0;
            errorCount = 0;

            currentText = generateText();
            render();

            btn.style.opacity = '0';
            btn.style.pointerEvents = 'none';
            display.focus();
        }

        display.addEventListener('keydown', (e) => {
            if (timeLeft <= 0) return;
            if (e.key === 'Shift' || e.key === 'Control' || e.key === 'Alt') return;

            if (!isRunning) start();

            const targetChar = currentText[cursorIndex];
            const typed = e.key;

            const letterEls = display.querySelectorAll('.letter');

            if (typed === 'Backspace') {
                if (cursorIndex > 0) {
                    cursorIndex--;
                    letterEls[cursorIndex].className = 'letter'; // reset status
                    // revert stats? simplistic approach: just stop counting them as correct
                }
            } else if (typed.length === 1) { // Printable
                // Correct?
                if (typed === targetChar) {
                    letterEls[cursorIndex].classList.add('correct');
                    correctChars++;
                } else {
                    letterEls[cursorIndex].classList.add('incorrect');
                    errorCount++;
                }
                totalChars++;
                cursorIndex++;
            }

            updateVisuals();

            // Stats
            const acc = totalChars > 0 ? ((totalChars - errorCount) / totalChars * 100) : 100;
            accEl.innerText = Math.round(acc) + '%';
        });

        // Init
        reset();
    </script>
</body>

</html>