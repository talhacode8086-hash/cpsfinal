<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grid Shot Mini - AssetsToolsHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .tool-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .grid-area {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 10px;
            width: 500px;
            height: 500px;
            margin: 2rem auto;
            position: relative;
        }

        .grid-cell {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            position: relative;
            cursor: crosshair;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .orb {
            width: 70px;
            height: 70px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s;
            animation: pop 0.2s;
            box-shadow: 0 0 15px var(--primary);
        }

        .orb:active {
            transform: scale(0.9);
        }

        @keyframes pop {
            from {
                transform: scale(0);
            }

            to {
                transform: scale(1);
            }
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <div class="main-content">
        <div class="tool-container">
            <h1 style="font-size: 2.5rem; font-weight:900; margin-bottom: 1rem;">Grid Shot Mini</h1>
            <p style="color:var(--text-muted); margin-bottom: 3rem;">Click the orbs as fast as possible. 3 orbs are
                always active.</p>

            <div class="stats">
                <div>Score: <span id="score" style="color:#6366f1">0</span></div>
                <div>Time: <span id="time">60s</span></div>
            </div>

            <div class="grid-area" id="grid">
                <!-- Cells generated by JS -->
                <div id="overlay"
                    style="position:absolute; inset:0; background:rgba(0,0,0,0.8); z-index:10; display:flex; align-items:center; justify-content:center; flex-direction:column">
                    <button class="join-pro-btn" style="width:auto" onclick="start()">PLAY</button>
                </div>
            </div>
        </div>
    </div>

    <script src="layout.js"></script>
    <script>
        const grid = document.getElementById('grid');
        const scoreEl = document.getElementById('score');
        const timeEl = document.getElementById('time');
        const overlay = document.getElementById('overlay');

        let cells = [];
        let score = 0;
        let activeIndices = [];
        let timeLeft = 60;
        let timer;
        let isRunning = false;

        // Init Grid
        for (let i = 0; i < 16; i++) {
            const cell = document.createElement('div');
            cell.className = 'grid-cell';
            grid.insertBefore(cell, overlay);
            cells.push(cell);
        }

        function start() {
            isRunning = true;
            score = 0;
            timeLeft = 60;
            scoreEl.innerText = 0;
            timeEl.innerText = '60s';
            overlay.style.display = 'none';
            activeIndices = [];

            // Clear board
            cells.forEach(c => c.innerHTML = '');

            // Spawn initial 3
            spawn(); spawn(); spawn();

            timer = setInterval(() => {
                timeLeft--;
                timeEl.innerText = timeLeft + 's';
                if (timeLeft <= 0) end();
            }, 1000);
        }

        function end() {
            isRunning = false;
            clearInterval(timer);
            overlay.style.display = 'flex';
            overlay.innerHTML = `
                <h2 style="font-size:2rem; margin-bottom:1rem">Results</h2>
                <div style="font-size:1.5rem; margin-bottom:2rem">Score: ${score}</div>
                <div style="color:var(--text-muted); margin-bottom:1rem">Approx ${(score / 60).toFixed(1)} hits/sec</div>
                <button class="join-pro-btn" style="width:auto" onclick="location.reload()">REPLAY</button>
            `;
        }

        function spawn() {
            if (activeIndices.length >= 16) return; // Full

            let idx;
            do {
                idx = Math.floor(Math.random() * 16);
            } while (activeIndices.includes(idx));

            activeIndices.push(idx);

            const orb = document.createElement('div');
            orb.className = 'orb';
            orb.onmousedown = (e) => {
                e.stopPropagation();
                hit(idx);
            };

            cells[idx].appendChild(orb);
        }

        function hit(idx) {
            if (!isRunning) return;
            score++;
            scoreEl.innerText = score;

            // Remove orb
            cells[idx].innerHTML = '';
            activeIndices = activeIndices.filter(i => i !== idx);

            // Spawn new
            spawn();

            // Play sound
            playSound();
        }

        function playSound() {
            const ac = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ac.createOscillator();
            const g = ac.createGain();
            osc.connect(g);
            g.connect(ac.destination);
            osc.frequency.setValueAtTime(600, ac.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, ac.currentTime + 0.1);
            g.gain.setValueAtTime(0.05, ac.currentTime);
            g.gain.linearRampToValueAtTime(0, ac.currentTime + 0.1);
            osc.start(); osc.stop(ac.currentTime + 0.1);
        }
    </script>
</body>

</html>