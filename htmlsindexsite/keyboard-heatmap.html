<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyboard Heatmap - AssetsToolsHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .tool-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .kb-container {
            background: #111;
            padding: 2rem;
            border-radius: 2rem;
            border: 1px solid var(--card-border);
            margin: 2rem 0;
            overflow-x: auto;
        }

        .kb-row {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 6px;
        }

        .key {
            width: 50px;
            height: 50px;
            border: 1px solid #374151;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 700;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1f2937;
            transition: background 0.2s, transform 0.05s;
            user-select: none;
            position: relative;
        }

        .key .count-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: black;
            color: white;
            font-size: 0.6rem;
            padding: 2px 4px;
            border-radius: 4px;
            display: none;
        }

        .key.has-data .count-badge {
            display: block;
        }

        .key:active {
            transform: scale(0.9);
        }

        /* Key Sizes */
        .w-1-5 {
            width: 75px;
        }

        .w-2 {
            width: 100px;
        }

        .w-2-5 {
            width: 120px;
        }

        .w-6 {
            width: 330px;
        }
    </style>
</head>

<body>
    <div class="main-content">
        <div class="tool-container">
            <h1 style="font-size: 2.5rem; font-weight:900; margin-bottom: 1rem;">Keyboard Heatmap <span
                    style="color:#fbbf24; font-size:1rem; vertical-align:middle; margin-left:10px">PRO</span></h1>
            <p style="color:var(--text-muted); margin-bottom: 3rem;">Visualise your frequently pressed keys. Type a
                paragraph or use your keyboard normally.</p>

            <div style="margin-bottom:2rem; display:flex; justify-content:center; gap:2rem">
                <div>Total Strokes: <span id="total" style="font-weight:800; color:var(--primary)">0</span></div>
                <div>Most Pressed: <span id="most" style="font-weight:800; color:white">-</span></div>
            </div>

            <div class="kb-container" id="keyboard">
                <!-- Copied layout from keyboard-check but simplified for heatmap -->
                <!-- Row 1 -->
                <div class="kb-row">
                    <div class="key" data-code="Escape">ESC</div>
                    <div class="key" data-code="F1">F1</div>
                    <div class="key" data-code="F2">F2</div>
                    <div class="key" data-code="F3">F3</div>
                    <div class="key" data-code="F4">F4</div>
                    <div class="key" data-code="F5">F5</div>
                    <div class="key" data-code="F6">F6</div>
                    <div class="key" data-code="F7">F7</div>
                    <div class="key" data-code="F8">F8</div>
                    <div class="key" data-code="F9">F9</div>
                    <div class="key" data-code="F10">F10</div>
                    <div class="key" data-code="F11">F11</div>
                    <div class="key" data-code="F12">F12</div>
                </div>
                <!-- Row 2 -->
                <div class="kb-row">
                    <div class="key" data-code="Backquote">`</div>
                    <div class="key" data-code="Digit1">1</div>
                    <div class="key" data-code="Digit2">2</div>
                    <div class="key" data-code="Digit3">3</div>
                    <div class="key" data-code="Digit4">4</div>
                    <div class="key" data-code="Digit5">5</div>
                    <div class="key" data-code="Digit6">6</div>
                    <div class="key" data-code="Digit7">7</div>
                    <div class="key" data-code="Digit8">8</div>
                    <div class="key" data-code="Digit9">9</div>
                    <div class="key" data-code="Digit0">0</div>
                    <div class="key" data-code="Minus">-</div>
                    <div class="key" data-code="Equal">=</div>
                    <div class="key w-2" data-code="Backspace">BACK</div>
                </div>
                <!-- Row 3 -->
                <div class="kb-row">
                    <div class="key w-1-5" data-code="Tab">TAB</div>
                    <div class="key" data-code="KeyQ">Q</div>
                    <div class="key" data-code="KeyW">W</div>
                    <div class="key" data-code="KeyE">E</div>
                    <div class="key" data-code="KeyR">R</div>
                    <div class="key" data-code="KeyT">T</div>
                    <div class="key" data-code="KeyY">Y</div>
                    <div class="key" data-code="KeyU">U</div>
                    <div class="key" data-code="KeyI">I</div>
                    <div class="key" data-code="KeyO">O</div>
                    <div class="key" data-code="KeyP">P</div>
                    <div class="key" data-code="BracketLeft">[</div>
                    <div class="key" data-code="BracketRight">]</div>
                    <div class="key w-1-5" data-code="Backslash">\</div>
                </div>
                <!-- Row 4 -->
                <div class="kb-row">
                    <div class="key w-2" data-code="CapsLock">CAPS</div>
                    <div class="key" data-code="KeyA">A</div>
                    <div class="key" data-code="KeyS">S</div>
                    <div class="key" data-code="KeyD">D</div>
                    <div class="key" data-code="KeyF">F</div>
                    <div class="key" data-code="KeyG">G</div>
                    <div class="key" data-code="KeyH">H</div>
                    <div class="key" data-code="KeyJ">J</div>
                    <div class="key" data-code="KeyK">K</div>
                    <div class="key" data-code="KeyL">L</div>
                    <div class="key" data-code="Semicolon">;</div>
                    <div class="key" data-code="Quote">'</div>
                    <div class="key w-2-5" data-code="Enter">ENTER</div>
                </div>
                <!-- Row 5 -->
                <div class="kb-row">
                    <div class="key w-2-5" data-code="ShiftLeft">SHIFT</div>
                    <div class="key" data-code="KeyZ">Z</div>
                    <div class="key" data-code="KeyX">X</div>
                    <div class="key" data-code="KeyC">C</div>
                    <div class="key" data-code="KeyV">V</div>
                    <div class="key" data-code="KeyB">B</div>
                    <div class="key" data-code="KeyN">N</div>
                    <div class="key" data-code="KeyM">M</div>
                    <div class="key" data-code="Comma">,</div>
                    <div class="key" data-code="Period">.</div>
                    <div class="key" data-code="Slash">/</div>
                    <div class="key w-2-5" data-code="ShiftRight">SHIFT</div>
                </div>
                <!-- Row 6 -->
                <div class="kb-row">
                    <div class="key w-1-5" data-code="ControlLeft">CTRL</div>
                    <div class="key" data-code="MetaLeft">WIN</div>
                    <div class="key w-1-5" data-code="AltLeft">ALT</div>
                    <div class="key w-6" data-code="Space">SPACE</div>
                    <div class="key w-1-5" data-code="AltRight">ALT</div>
                    <div class="key" data-code="MetaRight">FN</div>
                    <div class="key w-1-5" data-code="ControlRight">CTRL</div>
                </div>
            </div>

            <textarea
                style="width:100%; height:100px; padding:1rem; border-radius:1rem; border:1px solid #374151; background:#0d1117; color:#fff"
                placeholder="Type here to test normally..."></textarea>

            <button class="join-pro-btn" style="width:100%; margin-top:2rem" onclick="resetHeatmap()">RESET
                HEATMAP</button>
        </div>
    </div>

    <script src="layout.js"></script>
    <script>
        const counts = {};
        let total = 0;
        let maxCount = 0;

        const totalEl = document.getElementById('total');
        const mostEl = document.getElementById('most');

        // Add badges to all keys
        document.querySelectorAll('.key').forEach(k => {
            const b = document.createElement('div');
            b.className = 'count-badge';
            b.innerText = '0';
            k.appendChild(b);
        });

        window.addEventListener('keydown', (e) => {
            // e.preventDefault() only if we want to block input, but for textarea we might want it.
            // Let's block only some defaults so page doesn't scroll
            if (e.code === 'Space' && e.target.tagName !== 'TEXTAREA') e.preventDefault();

            const code = e.code;
            if (!counts[code]) counts[code] = 0;
            counts[code]++;
            total++;

            if (counts[code] > maxCount) maxCount = counts[code];

            totalEl.innerText = total;

            // Find most pressed
            const most = Object.entries(counts).reduce((a, b) => a[1] > b[1] ? a : b);
            mostEl.innerText = `${most[0].replace('Key', '')} (${most[1]})`;

            updateColors();
        });

        function updateColors() {
            document.querySelectorAll('.key').forEach(k => {
                const code = k.dataset.code;
                const count = counts[code] || 0;

                if (count > 0) {
                    k.classList.add('has-data');
                    k.querySelector('.count-badge').innerText = count;

                    // Heatmap color logic
                    const intensity = Math.min(count / Math.max(10, maxCount), 1); // Normalize
                    // Color from Blue #3b82f6 to Red #ef4444
                    // Simple HSL transition: Blue (217) to Red (0)
                    const hue = 217 - (intensity * 217);
                    k.style.background = `hsl(${hue}, 70%, 50%)`;
                    k.style.color = 'white';
                    k.style.borderColor = `hsl(${hue}, 70%, 40%)`;
                }
            });
        }

        function resetHeatmap() {
            for (let k in counts) delete counts[k];
            total = 0;
            maxCount = 0;
            totalEl.innerText = 0;
            mostEl.innerText = '-';
            document.querySelectorAll('.key').forEach(k => {
                k.classList.remove('has-data');
                k.style.background = '#1f2937';
                k.style.color = '#9ca3af';
                k.style.borderColor = '#374151';
                k.querySelector('.count-badge').innerText = '0';
            });
            document.querySelector('textarea').value = '';
        }
    </script>
</body>

</html>